---
name: linxcore
description: LinxCore (rtl/LinxCore) development workflow + block/BID/BROB/BISQ design decisions. Use for any LinxCore backend/bctrl work, especially block-structure (BSTART/BSTOP/EOB), BID allocation, and flush semantics.
---

# LinxCore skill

Canonical repo location (superproject checkout):

- `/home/zhoubot/linx-isa/rtl/LinxCore`

## Block/BID design decisions (strict)

These are confirmed in #linx-core (2026-02-24) and must be preserved by future changes:

1) **BID is generated by BROB**
- BID is the BROB entry identity.
- Default sizing: BROB is parameterized; **default entries = 128**.

2) **BID encoding**
- Keep 64-bit BID.
- `slot_id = BID[6:0]` (for 128 entries)
- `uniq = BID[63:7]` (debug uniqueness / age ordering)
- So: `BID = (uniq << 7) | slot_id`

3) **Tag routing**
- **cmd_tag = BID[7:0]**
- Rationale: PE response tags must route to the correct BROB entry; avoid any unrelated tag sources (e.g. cycles).

4) **Block completion**
- `complete = scalar_done && (needs_engine ? engine_done : 1)`
- `needs_engine` should be set when the block actually issues engine commands.

5) **BSTART / BSTOP semantics**
- `BSTART` uop in ROB carries the **new BID** (it belongs to the new block).
- `scalar_done` is triggered at **BSTART retire + BSTOP retire**.
  - On BSTART retire: mark scalar_done for the *old active bid* (implicit end).
  - On BSTOP retire: mark scalar_done for the current active bid (explicit end).

6) **Flush semantics (BID-based)**
- On a flush/redirect, the system reports the **current block BID** (the block where the flush is generated).
- All blocks **younger than this BID** must be cleared.
- Because slot ids wrap, comparisons must use full 64-bit BID ordering.
- Rule: **keep `bid <= flush_bid`, kill `bid > flush_bid`**.
- This applies to **all modules that carry/queue BID** (at minimum: BROB + BISQ + any other bid-carrying queues).

## PR checklist for BID/block changes

- [ ] Confirm `cmd_tag == bid[7:0]` through backend->bctrl->PE and response routing.
- [ ] Confirm flush path provides `flush_bid` and every bid-carrying module kills `bid > flush_bid`.
- [ ] Confirm BROB keeps `bid <= flush_bid` (including current block) and handles wrap via uniq bits.
- [ ] Update docs/skills when new edge cases are discovered.

## When merging LinxCore PRs

After merging to `LinxISA/LinxCore`, bump the superproject gitlink:

- `/home/zhoubot/linx-isa` â†’ update `rtl/LinxCore` submodule pointer on `main`, PR + merge.
